<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Niji Trip 2026</title>

<style>
body{
  margin:0;
  font-family: system-ui, -apple-system, "Noto Sans TC", sans-serif;
  background:#fde3b6;
  color:#6b3f1f;
}
header{
  padding:16px;
  font-size:24px;
  font-weight:900;
}
main{
  padding:12px;
}
.card{
  background:#fff6e6;
  border-radius:18px;
  padding:14px;
  margin-bottom:14px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.row{margin-bottom:10px;}
input, textarea, select{
  width:100%;
  border:none;
  border-radius:12px;
  padding:10px;
  font-size:14px;
  outline:none;
  box-sizing:border-box;
}
textarea{resize:vertical;}
select{
  font-weight:700;
  background:#ffe1b3;
}
.note{
  background:#fff;
  border:2px dashed #e7b97e;
  border-radius:12px;
  padding:10px;
}
.note textarea{
  border:none;
  background:transparent;
  padding:0;
  min-height:60px;
}
.noteImages{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:8px;
}
.noteImages img{
  width:70px;
  height:70px;
  object-fit:cover;
  border-radius:10px;
  cursor:pointer;
  border:1px solid #e7b97e;
}
button{
  padding:10px 14px;
  border:none;
  border-radius:999px;
  font-weight:800;
  background:#ffbf6e;
}
</style>
</head>

<body>
<header>
  ðŸŒˆ Niji Trip 2026
</header>

<main>
  <button id="addCard">ï¼‹ æ–°å¢žè¡Œç¨‹</button>
  <div id="cards"></div>
</main>

<script>
const STORAGE_KEY = "niji_trip_stable_v1";

let state = {
  cards:[]
};

function save(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

function load(){
  const raw = localStorage.getItem(STORAGE_KEY);
  if(raw) state = JSON.parse(raw);
}

function render(){
  const wrap = document.getElementById("cards");
  wrap.innerHTML = "";
  state.cards.forEach(card=>{
    wrap.appendChild(renderCard(card));
  });
}

function newCard(){
  return {
    id:Date.now()+Math.random(),
    type:"æ™¯é»ž",
    title:"",
    note:"",
    noteImages:[]
  };
}

function renderCard(card){
  const el = document.createElement("div");
  el.className = "card";

  // é¡žåž‹ä¸‹æ‹‰ï¼ˆæ¨™è¨˜1ï¼‰
  const typeSel = document.createElement("select");
  ["æ™¯é»ž","é¤å»³","äº¤é€š","è³¼ç‰©"].forEach(t=>{
    const o = document.createElement("option");
    o.value=t; o.textContent=t;
    if(card.type===t) o.selected=true;
    typeSel.appendChild(o);
  });
  typeSel.onchange = ()=>{
    card.type = typeSel.value;
    save();
  };

  // æ¨™é¡Œ
  const title = document.createElement("input");
  title.placeholder = "æ¨™é¡Œ";
  title.value = card.title;
  title.oninput = ()=>{
    card.title = title.value;
    save();
  };

  // å‚™è¨»ï¼ˆæ¨™è¨˜2 + æ‹–åœ–ç‰‡ï¼‰
  const noteBox = document.createElement("div");
  noteBox.className = "note";

  const note = document.createElement("textarea");
  note.placeholder = "å‚™è¨»ï¼ˆå¯æ‹–åœ–ç‰‡é€²ä¾†ï¼‰";
  note.value = card.note;
  note.oninput = ()=>{
    card.note = note.value;
    save();
  };

  const imgWrap = document.createElement("div");
  imgWrap.className = "noteImages";

  function renderImages(){
    imgWrap.innerHTML = "";
    card.noteImages.forEach((src,i)=>{
      const img = document.createElement("img");
      img.src = src;
      img.onclick = ()=>{
        card.noteImages.splice(i,1);
        renderImages();
        save();
      };
      imgWrap.appendChild(img);
    });
  }
  renderImages();

  noteBox.ondragover = e=>e.preventDefault();
  noteBox.ondrop = e=>{
    e.preventDefault();
    const file = e.dataTransfer.files[0];
    if(!file || !file.type.startsWith("image")) return;
    const r = new FileReader();
    r.onload = ()=>{
      card.noteImages.push(r.result);
      renderImages();
      save();
    };
    r.readAsDataURL(file);
  };

  noteBox.appendChild(note);
  noteBox.appendChild(imgWrap);

  el.appendChild(typeSel);
  el.appendChild(title);
  el.appendChild(noteBox);

  return el;
}

document.getElementById("addCard").onclick = ()=>{
  state.cards.push(newCard());
  save();
  render();
};

load();
render();
</script>
</body>
</html>

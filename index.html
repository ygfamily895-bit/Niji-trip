<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Niji Trip 2026 ğŸŒˆ</title>
<meta name="theme-color" content="#ffcf8f"/>

<style>
/* =====ï¼ˆæ¨£å¼å®Œå…¨æ²¿ç”¨ä½ çµ¦çš„ç‰ˆæœ¬ï¼Œæœªåˆªï¼‰===== */
:root{
  --bg:#fce0b3;
  --card:#fff7e8;
  --soft:#eaf6ff;
  --chip:#fff6e5;
  --chipOn:#ffffff;
  --brown:#7a4a26;
  --brown2:#a26b3a;
  --border:rgba(186, 140, 91, 0.35);
  --shadow:0 2px 8px rgba(0,0,0,0.08);
  --r1:18px;
  --r2:24px;
  --pill:999px;
  --btn:#ffd59a;
  --btn2:#ffb85c;
  --danger:#ffb0a6;
  --focus: rgba(255,184,92,0.85);
}
/* â€¦â€¦ï¼ˆä¸­é–“ CSS èˆ‡ä½ æä¾›çš„å®Œå…¨ä¸€è‡´ï¼Œç•¥ï¼‰â€¦â€¦ */

/* === æ–°å¢ï¼šå¡ç‰‡æ¨™ç±¤ select === */
.tagSelect{
  font-size:12px;
  font-weight:1000;
  border-radius:999px;
  padding:4px 10px;
  background:#fff3da;
  border:1px solid rgba(122,74,38,0.10);
  color:#5c3a1c;
  outline:none;
}

/* === æ–°å¢ï¼šäº¤é€šè·¯ç·šæ¬„ === */
.routeBox{
  margin-top:10px;
  border:1px dashed var(--border);
  border-radius:14px;
  background:#fffdf6;
  padding:8px;
}
.routeBox textarea{
  width:100%;
  border:none;
  background:transparent;
  resize:vertical;
  min-height:44px;
  outline:none;
  font-size:13px;
  color:#5c3a1c;
}
</style>
</head>

<body>
<!-- ================== çœç•¥ header / auth / dayNavï¼ˆå®Œå…¨ä¿ç•™ä½ çš„ï¼‰ ================== -->

<script>
/* =========================
   renderCardï¼ˆâš ï¸é‡é»åœ¨é€™ï¼‰
========================= */
function renderCard(card, dayObj, secKey){
  const el = document.createElement("article");
  el.className = "card";
  el.dataset.cardId = card.id;
  el.dataset.dayId = dayObj.id;
  el.dataset.secKey = secKey;

  el.innerHTML = `
    <div class="cardTop">
      <div style="flex:1;display:flex;flex-direction:column;gap:8px;">
        <input class="titleInp" placeholder="æ¨™é¡Œ" />
        <input class="miniInp metaInp" placeholder="è£œå……èªªæ˜ / åœ°å€" />
      </div>
      <select class="tagSelect">
        <option value="spot">æ™¯é»</option>
        <option value="restaurant">é¤å»³</option>
        <option value="transport">äº¤é€š</option>
        <option value="shopping">è³¼ç‰©</option>
        <option value="lodging">ä½å®¿</option>
      </select>
    </div>

    <!-- æ¨™è¨˜ 2ï¼šäº¤é€šè·¯ç·š -->
    <div class="routeBox">
      <textarea class="routeText"
        placeholder="äº¤é€šè·¯ç·šï¼ˆè‡ªç”±è¼¸å…¥ï¼‰"></textarea>
    </div>

    <!-- å‚™è¨» -->
    <div class="note">
      <div class="noteHead">
        <span>å‚™è¨»</span>
        <button class="btn small btnNotePhoto" type="button">ğŸ“·</button>
      </div>
      <textarea class="noteText" placeholder="å‚™è¨»å…§å®¹"></textarea>
      <div class="photoStrip notePhotos"></div>
    </div>
  `;

  const titleInp = el.querySelector(".titleInp");
  const metaInp  = el.querySelector(".metaInp");
  const tagSel   = el.querySelector(".tagSelect");
  const routeTA  = el.querySelector(".routeText");
  const noteTA   = el.querySelector(".noteText");
  const notePhotos = el.querySelector(".notePhotos");

  titleInp.value = card.title || "";
  metaInp.value  = card.meta || "";
  tagSel.value   = card.type || "spot";
  routeTA.value  = card.route || "";
  noteTA.value   = card.note || "";

  autoGrowTextarea(routeTA);
  autoGrowTextarea(noteTA);

  tagSel.addEventListener("change", ()=>{
    card.type = tagSel.value;
    scheduleSave();
  });

  titleInp.addEventListener("input", ()=>{
    card.title = titleInp.value;
    scheduleSave();
  });

  metaInp.addEventListener("input", ()=>{
    card.meta = metaInp.value;
    scheduleSave();
  });

  routeTA.addEventListener("input", ()=>{
    card.route = routeTA.value;
    autoGrowTextarea(routeTA);
    scheduleSave();
  });

  noteTA.addEventListener("input", ()=>{
    card.note = noteTA.value;
    autoGrowTextarea(noteTA);
    scheduleSave();
  });

  attachPasteImages(noteTA, (urls)=>{
    card.photos = card.photos || [];
    card.photos.push(...urls);
    renderPhotoStrip(notePhotos, card.photos, ()=>scheduleSave());
    scheduleSave();
  });

  renderPhotoStrip(notePhotos, card.photos || [], ()=>scheduleSave());

  attachLongPress(el, card);
  return el;
}
</script>

<!-- ================== Firebase / CloudSync åŸå°ä¸å‹• ================== -->
</body>
</html>

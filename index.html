<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Niji Trip 2026</title>

<style>
:root {
  --bg-main:#ffe4b8;
  --bg-card:#fff7e8;
  --brown:#7a4a26;
  --radius:20px;
}

body{
  margin:0;
  font-family:system-ui,-apple-system,"Noto Sans TC";
  background:var(--bg-main);
}

header{
  padding:16px;
  background:#fff3da;
  border-radius:0 0 var(--radius) var(--radius);
}

h1{
  margin:0 0 6px;
  color:var(--brown);
}

.btn-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:10px;
}

button{
  border:none;
  padding:8px 14px;
  border-radius:999px;
  background:#ffd89a;
  color:#5c3a1c;
  font-weight:bold;
}

main{
  padding:16px;
}

.day{
  background:#eaf6ff;
  border-radius:var(--radius);
  padding:14px;
  margin-bottom:14px;
}

.card{
  background:var(--bg-card);
  border-radius:16px;
  padding:12px;
  margin-top:10px;
}

[contenteditable]{
  outline:none;
}
</style>
</head>

<body>

<header>
  <h1>Niji Trip 2026 ğŸŒˆ</h1>
  <div contenteditable="true">
    æ±äº¬è¡Œç¨‹ï¼Œå¯è‡ªç”±ç·¨è¼¯ã€‚
  </div>

  <div class="btn-row">
    <button id="addDayBtn">ï¼‹ æ–°å¢ä¸€å¤©</button>
    <button id="clearBtn">æ¸…é™¤å„²å­˜</button>
    <button class="btn" type="button" id="btnGoogleLogin">Google ç™»å…¥</button>
  </div>
</header>

<main id="days"></main>

<script>
const daysEl = document.getElementById("days");
const addDayBtn = document.getElementById("addDayBtn");
const clearBtn = document.getElementById("clearBtn");

let days = JSON.parse(localStorage.getItem("days") || "[]");

function save(){
  localStorage.setItem("days", JSON.stringify(days));
}

function render(){
  daysEl.innerHTML = "";
  days.forEach((d,i)=>{
    const el = document.createElement("div");
    el.className = "day";
    el.innerHTML = `
      <strong>Day ${i+1}</strong>
      <div class="card" contenteditable="true">${d.text}</div>
    `;
    el.querySelector(".card").oninput = e=>{
      days[i].text = e.target.innerText;
      save();
    };
    daysEl.appendChild(el);
  });
}

addDayBtn.onclick = ()=>{
  days.push({ text:"æ–°å¢è¡Œç¨‹å…§å®¹â€¦" });
  save();
  render();
};

clearBtn.onclick = ()=>{
  if(confirm("ç¢ºå®šæ¸…é™¤æ‰€æœ‰è³‡æ–™ï¼Ÿ")){
    localStorage.removeItem("days");
    days = [];
    render();
  }
};

render();
  // âœ… Google ç™»å…¥æŒ‰éˆ•ï¼ˆå…ˆåš UI æ¸¬è©¦ï¼Œä¸æ¥ Firebaseï¼‰
const btnGoogleLogin = document.getElementById("btnGoogleLogin");
if (btnGoogleLogin) {
  btnGoogleLogin.addEventListener("click", () => {
    alert("Google ç™»å…¥æŒ‰éˆ•å·²é»åˆ° âœ…ï¼ˆä¸‹ä¸€æ­¥æ‰æœƒæ¥ Firebaseï¼‰");
  });
}
</script>
<script type="module">
  // Firebase CDNï¼ˆæ‰‹æ©Ÿå»ºè­°ç”¨ redirectï¼‰
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getAuth,
    GoogleAuthProvider,
    signInWithRedirect,
    getRedirectResult,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // ğŸ”‘ ä½ çš„ Firebase è¨­å®šï¼ˆä½ ä¹‹å‰ç”¨éçš„é‚£çµ„ï¼‰
  const firebaseConfig = {
    apiKey: "AIzaSyAkFpjZVwRDA92YLK-JfDPeoHJ3hbgKVXM",
    authDomain: "trip-db86d.firebaseapp.com",
    projectId: "trip-db86d",
    storageBucket: "trip-db86d.firebasestorage.app",
    messagingSenderId: "709795426974",
    appId: "1:709795426974:web:ec3e2f03f2116b68c1418f"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const authStatus = document.getElementById("authStatus");

// åˆå§‹å…ˆéš±è—ç™»å‡º
if (logoutBtn) logoutBtn.style.display = "none";

onAuthStateChanged(auth, (user) => {
  if (user) {
    // âœ… å·²ç™»å…¥
    if (authStatus) authStatus.textContent = `å·²ç™»å…¥ï¼š${user.email || user.displayName || "Googleä½¿ç”¨è€…"}`;
    if (loginBtn) loginBtn.style.display = "none";
    if (logoutBtn) logoutBtn.style.display = "inline-block";
  } else {
    // âœ… æœªç™»å…¥
    if (authStatus) authStatus.textContent = "æœªç™»å…¥";
    if (loginBtn) loginBtn.style.display = "inline-block";
    if (logoutBtn) logoutBtn.style.display = "none";
  }
});

loginBtn?.addEventListener("click", async () => {
  await signInWithRedirect(auth, provider);
});

logoutBtn?.addEventListener("click", async () => {
  await signOut(auth);
});

  // é»æ“Š Google ç™»å…¥
  const btn = document.getElementById("btnGoogleLogin");
  if (btn) {
    btn.onclick = () => {
      signInWithRedirect(auth, provider);
    };
  }

  // ç™»å…¥å®Œæˆå¾Œï¼ˆé‡æ–°å°å›é é¢ï¼‰
  getRedirectResult(auth).catch(() => {});

  // ç›£è½ç™»å…¥ç‹€æ…‹
  onAuthStateChanged(auth, (user) => {
    if (user) {
      alert("ç™»å…¥æˆåŠŸ ğŸ‰\n" + user.email);
    }
  });
</script>
</body>
</html>

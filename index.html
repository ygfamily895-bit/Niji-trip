<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Niji Trip 2026</title>

<style>
:root {
  --bg-main:#ffe4b8;
  --bg-card:#fff7e8;
  --brown:#7a4a26;
  --radius:20px;
}

body{
  margin:0;
  font-family:system-ui,-apple-system,"Noto Sans TC";
  background:var(--bg-main);
}

header{
  padding:16px;
  background:#fff3da;
  border-radius:0 0 var(--radius) var(--radius);
}

h1{
  margin:0 0 6px;
  color:var(--brown);
}

.btn-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:10px;
  align-items:center;
}

button{
  border:none;
  padding:8px 14px;
  border-radius:999px;
  background:#ffd89a;
  color:#5c3a1c;
  font-weight:bold;
}

#authStatus{
  font-size:13px;
  font-weight:bold;
  color:#7a4a26;
  background:#fff3cd;
  padding:6px 10px;
  border-radius:8px;
  display:inline-block;
}

main{
  padding:16px;
}

.day{
  background:#eaf6ff;
  border-radius:var(--radius);
  padding:14px;
  margin-bottom:14px;
}

.card{
  background:var(--bg-card);
  border-radius:16px;
  padding:12px;
  margin-top:10px;
}

[contenteditable]{ outline:none; }
</style>
</head>

<body>

<header>
  <h1>Niji Trip 2026 ğŸŒˆ</h1>
  <div contenteditable="true">
    æ±äº¬è¡Œç¨‹ï¼Œå¯è‡ªç”±ç·¨è¼¯ã€‚
  </div>

  <div class="btn-row">
    <button id="addDayBtn">ï¼‹ æ–°å¢ä¸€å¤©</button>
    <button id="clearBtn">æ¸…é™¤å„²å­˜</button>
    <button type="button" id="btnGoogleLogin">Google ç™»å…¥</button>
    <span id="authStatus">æœªç™»å…¥</span>
  </div>
</header>

<main id="days"></main>

<!-- âœ… ä½ çš„æœ¬æ©Ÿè¡Œç¨‹åŠŸèƒ½ï¼ˆä¿æŒä¸å‹•ï¼‰ -->
<script>
const daysEl = document.getElementById("days");
const addDayBtn = document.getElementById("addDayBtn");
const clearBtn = document.getElementById("clearBtn");

let days = JSON.parse(localStorage.getItem("days") || "[]");

function save(){
  localStorage.setItem("days", JSON.stringify(days));
}

function render(){
  daysEl.innerHTML = "";
  days.forEach((d,i)=>{
    const el = document.createElement("div");
    el.className = "day";
    el.innerHTML = `
      <strong>Day ${i+1}</strong>
      <div class="card" contenteditable="true">${d.text}</div>
    `;
    el.querySelector(".card").oninput = e=>{
      days[i].text = e.target.innerText;
      save();
    };
    daysEl.appendChild(el);
  });
}

addDayBtn.onclick = ()=>{
  days.push({ text:"æ–°å¢è¡Œç¨‹å…§å®¹â€¦" });
  save();
  render();
};

clearBtn.onclick = ()=>{
  if(confirm("ç¢ºå®šæ¸…é™¤æ‰€æœ‰è³‡æ–™ï¼Ÿ")){
    localStorage.removeItem("days");
    days = [];
    render();
  }
};

render();
</script>

<!-- âœ… Firebase + Google ç™»å…¥ï¼ˆä¹¾æ·¨ç‰ˆï¼‰ -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getAuth,
    GoogleAuthProvider,
    signInWithRedirect,
    getRedirectResult,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAkFpjZVwRDA92YLK-JfDPeoHJ3hbgKVXM",
    authDomain: "trip-db86d.firebaseapp.com",
    projectId: "trip-db86d",
    storageBucket: "trip-db86d.firebasestorage.app",
    messagingSenderId: "709795426974",
    appId: "1:709795426974:web:ec3e2f03f2116b68c1418f"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  const btnGoogleLogin = document.getElementById("btnGoogleLogin");
  const authStatus = document.getElementById("authStatus");

  // é»æ“Šç™»å…¥ï¼ˆredirect æœ€ç©©ï¼‰
  btnGoogleLogin.addEventListener("click", () => {
    signInWithRedirect(auth, provider);
  });

  // å›ä¾†å¾Œå–çµæœï¼ˆå¯æœ‰å¯ç„¡ï¼Œä½†å»ºè­°æ”¾ï¼‰
  getRedirectResult(auth).catch(() => {});

  // ç›£è½ç™»å…¥ç‹€æ…‹ â†’ æ›´æ–°ç•«é¢
  onAuthStateChanged(auth, (user) => {
    if (user) {
      authStatus.textContent = `å·²ç™»å…¥ï¼š${user.email || user.displayName || "Google ä½¿ç”¨è€…"}`;
      btnGoogleLogin.textContent = "å·²ç™»å…¥";
      btnGoogleLogin.disabled = true;
    } else {
      authStatus.textContent = "æœªç™»å…¥";
      btnGoogleLogin.textContent = "Google ç™»å…¥";
      btnGoogleLogin.disabled = false;
    }
  });
</script>

</body>
</html>

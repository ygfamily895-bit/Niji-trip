<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Niji Trip 2026</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Noto Sans TC",sans-serif;
  background:#ffe0b3;
  color:#6b3f1d;
}
.page{max-width:900px;margin:auto;padding:12px 12px 120px}
.card{
  background:#fff7e8;
  border-radius:20px;
  padding:14px;
  margin-bottom:14px;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
}
input,textarea,select{
  width:100%;
  border:none;
  border-radius:14px;
  padding:10px 12px;
  font-size:14px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
  outline:none;
}
textarea{
  resize:none;
  overflow:hidden;
}
.row{display:flex;gap:8px;flex-wrap:wrap}
.btn{
  border:none;
  border-radius:999px;
  padding:8px 14px;
  background:#ffd28a;
  font-weight:700;
}
.tagSelect{
  font-weight:700;
}
.photo{
  width:72px;height:72px;
  border-radius:10px;
  object-fit:cover;
  margin:4px;
}
.notePhotos{display:flex;flex-wrap:wrap}
</style>
</head>

<body>
<div class="page">

<h1>Niji Trip 2026 ğŸŒˆ</h1>

<div id="cards"></div>

<button class="btn" onclick="addCard()">ï¼‹ æ–°å¢å¡ç‰‡</button>

</div>

<input type="file" id="imgPick" accept="image/*" hidden>

<script>
const cardsEl = document.getElementById("cards");
const imgPick = document.getElementById("imgPick");
let imgTarget = null;

let state = JSON.parse(localStorage.getItem("niji_final")) || {
  cards:[]
};

function save(){
  localStorage.setItem("niji_final",JSON.stringify(state));
}

function autoGrow(t){
  t.style.height="auto";
  t.style.height=t.scrollHeight+"px";
}

function addCard(){
  state.cards.push({
    type:"æ™¯é»",
    title:"",
    route:"",
    note:"",
    photos:[]
  });
  render();
  save();
}

function render(){
  cardsEl.innerHTML="";
  state.cards.forEach((c,i)=>{
    const el=document.createElement("div");
    el.className="card";
    el.innerHTML=`
      <select class="tagSelect">
        <option>æ™¯é»</option>
        <option>é¤å»³</option>
        <option>äº¤é€š</option>
        <option>è³¼ç‰©</option>
      </select>

      <input placeholder="æ¨™é¡Œ">

      <textarea placeholder="äº¤é€šè·¯ç·šï¼ˆè‡ªç”±è¼¸å…¥ï¼‰"></textarea>

      <textarea placeholder="å‚™è¨»ï¼ˆå¯æ‹–åœ–ç‰‡ï¼‰"></textarea>

      <div class="notePhotos"></div>

      <button class="btn small">ğŸ“· åŠ åœ–ç‰‡</button>
    `;

    const sel=el.querySelector("select");
    const title=el.querySelectorAll("input")[0];
    const route=el.querySelectorAll("textarea")[0];
    const note=el.querySelectorAll("textarea")[1];
    const photos=el.querySelector(".notePhotos");
    const btn=el.querySelector("button");

    sel.value=c.type;
    title.value=c.title;
    route.value=c.route;
    note.value=c.note;

    autoGrow(route);
    autoGrow(note);

    sel.onchange=()=>{c.type=sel.value;save();}
    title.oninput=()=>{c.title=title.value;save();}
    route.oninput=()=>{c.route=route.value;autoGrow(route);save();}
    note.oninput=()=>{c.note=note.value;autoGrow(note);save();}

    btn.onclick=()=>{
      imgTarget=c;
      imgPick.click();
    }

    photos.innerHTML="";
    c.photos.forEach((p,pi)=>{
      const img=document.createElement("img");
      img.src=p;
      img.className="photo";
      img.onclick=()=>{
        c.photos.splice(pi,1);
        render();save();
      }
      photos.appendChild(img);
    });

    cardsEl.appendChild(el);
  });
}

imgPick.onchange=()=>{
  const f=imgPick.files[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=e=>{
    imgTarget.photos.push(e.target.result);
    render();save();
  }
  r.readAsDataURL(f);
}

render();
</script>
</body>
</html>
